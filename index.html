<!DOCTYPE html>
<html lang="zh-TW">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>ğŸ“° å…¨çƒæ–°èæ”¶é›†ç³»çµ±</title>
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
   <style>
       /* åŸºç¤æ¨£å¼é‡ç½® */
       * {
           margin: 0;
           padding: 0;
           box-sizing: border-box;
       }
      
       :root {
           --primary: #4285f4;
           --primary-dark: #3367d6;
           --secondary: #34a853;
           --secondary-dark: #2d8c47;
           --danger: #ea4335;
           --warning: #fbbc05;
           --light: #f8f9fa;
           --dark: #202124;
           --gray: #5f6368;
           --light-gray: #dadce0;
           --card-shadow: 0 2px 8px rgba(0,0,0,0.1);
           --card-shadow-hover: 0 8px 24px rgba(0,0,0,0.15);
           --transition: all 0.3s ease;
       }
      
       body {
           font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft JhengHei', sans-serif;
           background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
           color: var(--dark);
           line-height: 1.6;
           min-height: 100vh;
           padding: 20px;
       }
      
       .container {
           max-width: 1600px;
           margin: 0 auto;
       }
      
       /* é é¦–æ¨£å¼ */
       .header {
           background: white;
           border-radius: 16px;
           padding: 30px;
           margin-bottom: 30px;
           box-shadow: var(--card-shadow);
           text-align: center;
           position: relative;
           overflow: hidden;
       }
      
       .header::before {
           content: '';
           position: absolute;
           top: 0;
           left: 0;
           width: 100%;
           height: 4px;
           background: linear-gradient(90deg, var(--primary), var(--secondary), var(--warning), var(--danger));
       }
      
       .header h1 {
           font-size: 2.5rem;
           margin-bottom: 10px;
           color: var(--dark);
       }
      
       .header p {
           color: var(--gray);
           font-size: 1.1rem;
           max-width: 800px;
           margin: 0 auto;
       }
      
       /* ä¾†æºæ¨™ç±¤ */
       .source-tag {
           display: inline-block;
           padding: 4px 12px;
           margin: 5px;
           background: var(--light);
           border-radius: 20px;
           font-size: 0.85rem;
           color: var(--gray);
           border: 1px solid var(--light-gray);
       }
      
       .source-tag.tw { border-left: 4px solid var(--secondary); }
       .source-tag.intl { border-left: 4px solid var(--primary); }
      
       /* æ§åˆ¶é¢æ¿ */
       .controls {
           display: flex;
           gap: 12px;
           margin-bottom: 30px;
           flex-wrap: wrap;
           justify-content: center;
       }
      
       .btn {
           padding: 12px 24px;
           border: none;
           border-radius: 8px;
           font-size: 1rem;
           font-weight: 600;
           cursor: pointer;
           transition: var(--transition);
           display: inline-flex;
           align-items: center;
           gap: 8px;
       }
      
       .btn-primary {
           background: var(--primary);
           color: white;
       }
      
       .btn-primary:hover {
           background: var(--primary-dark);
           transform: translateY(-2px);
           box-shadow: 0 4px 12px rgba(66, 133, 244, 0.3);
       }
      
       .btn-secondary {
           background: var(--secondary);
           color: white;
       }
      
       .btn-secondary:hover {
           background: var(--secondary-dark);
           transform: translateY(-2px);
           box-shadow: 0 4px 12px rgba(52, 168, 83, 0.3);
       }
      
       .btn-outline {
           background: white;
           color: var(--primary);
           border: 2px solid var(--primary);
       }
      
       .btn-outline:hover {
           background: var(--primary);
           color: white;
       }
      
       /* ç‹€æ…‹é¡¯ç¤º */
       .status-bar {
           display: grid;
           grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
           gap: 20px;
           margin-bottom: 30px;
       }
      
       .status-card {
           background: white;
           padding: 20px;
           border-radius: 12px;
           box-shadow: var(--card-shadow);
           text-align: center;
           transition: var(--transition);
       }
      
       .status-card:hover {
           transform: translateY(-5px);
           box-shadow: var(--card-shadow-hover);
       }
      
       .status-icon {
           font-size: 2.5rem;
           margin-bottom: 15px;
       }
      
       .status-value {
           font-size: 2.2rem;
           font-weight: 700;
           color: var(--primary);
           margin-bottom: 5px;
       }
      
       .status-label {
           color: var(--gray);
           font-size: 0.95rem;
       }
      
       /* è¼‰å…¥å‹•ç•« */
       .loading {
           text-align: center;
           padding: 60px 20px;
           background: white;
           border-radius: 16px;
           box-shadow: var(--card-shadow);
           margin-bottom: 30px;
       }
      
       .loader {
           width: 60px;
           height: 60px;
           border: 5px solid #f3f3f3;
           border-top: 5px solid var(--primary);
           border-radius: 50%;
           animation: spin 1s linear infinite;
           margin: 0 auto 25px;
       }
      
       @keyframes spin {
           0% { transform: rotate(0deg); }
           100% { transform: rotate(360deg); }
       }
      
       /* éŒ¯èª¤è¨Šæ¯ */
       .error-message {
           background: #ffebee;
           color: var(--danger);
           padding: 20px;
           border-radius: 12px;
           margin-bottom: 30px;
           border-left: 5px solid var(--danger);
           display: flex;
           align-items: center;
           gap: 12px;
       }
      
       /* æ–°èä¾†æºçµ±è¨ˆ */
       .sources-stats {
           background: white;
           border-radius: 16px;
           padding: 25px;
           margin-bottom: 30px;
           box-shadow: var(--card-shadow);
       }
      
       .sources-grid {
           display: grid;
           grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
           gap: 15px;
           margin-top: 20px;
       }
      
       .source-item {
           display: flex;
           justify-content: space-between;
           padding: 12px;
           background: var(--light);
           border-radius: 8px;
           border-left: 4px solid var(--primary);
       }
      
       .source-name {
           font-weight: 600;
       }
      
       .source-count {
           background: var(--primary);
           color: white;
           padding: 2px 8px;
           border-radius: 12px;
           font-size: 0.85rem;
       }
      
       /* æ–°èå¡ç‰‡ */
       .news-grid {
           display: grid;
           grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
           gap: 25px;
           margin-bottom: 40px;
       }
      
       .news-card {
           background: white;
           border-radius: 16px;
           overflow: hidden;
           box-shadow: var(--card-shadow);
           transition: var(--transition);
           display: flex;
           flex-direction: column;
           height: 100%;
       }
      
       .news-card:hover {
           transform: translateY(-8px);
           box-shadow: var(--card-shadow-hover);
       }
      
       .news-category {
           padding: 10px 20px;
           color: white;
           font-weight: 600;
           text-align: center;
       }
      
       .category-tech { background: var(--primary); }
       .category-finance { background: var(--secondary); }
       .category-politics { background: #9c27b0; }
       .category-health { background: #00bcd4; }
       .category-environment { background: #4caf50; }
       .category-education { background: #ff9800; }
       .category-sports { background: #e91e63; }
       .category-entertainment { background: #673ab7; }
       .category-world { background: #2196f3; }
       .category-other { background: var(--gray); }
      
       .news-content {
           padding: 25px;
           flex-grow: 1;
           display: flex;
           flex-direction: column;
       }
      
       .news-title {
           font-size: 1.3rem;
           font-weight: 600;
           margin-bottom: 15px;
           color: var(--dark);
           line-height: 1.4;
       }
      
       .news-summary {
           color: var(--gray);
           margin-bottom: 20px;
           line-height: 1.6;
           font-size: 0.95rem;
           flex-grow: 1;
       }
      
       .news-meta {
           display: flex;
           justify-content: space-between;
           align-items: center;
           font-size: 0.9rem;
           color: var(--gray);
           padding-top: 20px;
           border-top: 1px solid var(--light-gray);
           margin-top: auto;
       }
      
       .news-source {
           font-weight: 600;
           color: var(--primary);
           display: flex;
           align-items: center;
           gap: 6px;
       }
      
       .news-date {
           color: var(--gray);
       }
      
       .news-link {
           display: inline-flex;
           align-items: center;
           gap: 6px;
           color: var(--primary);
           text-decoration: none;
           font-weight: 600;
           transition: var(--transition);
           margin-top: 15px;
       }
      
       .news-link:hover {
           color: var(--primary-dark);
           gap: 10px;
       }
      
       /* é å°¾ */
       .footer {
           text-align: center;
           padding: 25px;
           color: var(--gray);
           font-size: 0.9rem;
           background: white;
           border-radius: 16px;
           box-shadow: var(--card-shadow);
           margin-top: 40px;
       }
      
       /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
       @media (max-width: 768px) {
           .header h1 { font-size: 2rem; }
           .news-grid { grid-template-columns: 1fr; }
           .status-bar { grid-template-columns: 1fr 1fr; }
           .controls { flex-direction: column; }
           .btn { justify-content: center; }
           body { padding: 15px; }
           .sources-grid { grid-template-columns: 1fr 1fr; }
       }
      
       @media (max-width: 480px) {
           .status-bar { grid-template-columns: 1fr; }
           .header h1 { font-size: 1.8rem; }
           .header { padding: 20px; }
           body { padding: 10px; }
           .sources-grid { grid-template-columns: 1fr; }
       }
   </style>
</head>
<body>
   <div class="container">
       <!-- é é¦– -->
       <div class="header">
           <h1><i class="fas fa-globe-americas"></i> å…¨çƒæ–°èæ”¶é›†ç³»çµ±</h1>
           <p>æ”¶é›†å…¨çƒ 8 å¤§æ–°èä¾†æºï¼Œå³æ™‚æ›´æ–° 50+ å‰‡æœ€æ–°æ–°è</p>
           <div style="margin-top: 15px;">
               <span class="source-tag tw"><i class="fas fa-map-marker-alt"></i> å°ç£æ–°è (3)</span>
               <span class="source-tag intl"><i class="fas fa-globe"></i> åœ‹éš›æ–°è (5)</span>
               <span class="source-tag"><i class="fas fa-newspaper"></i> ç¸½æ•¸: 50+ å‰‡</span>
           </div>
       </div>
      
       <!-- æ§åˆ¶æŒ‰éˆ• -->
       <div class="controls">
           <button class="btn btn-primary" onclick="loadNews()" id="loadBtn">
               <i class="fas fa-sync-alt"></i> æ›´æ–°æ–°è
           </button>
           <button class="btn btn-secondary" onclick="showStats()">
               <i class="fas fa-chart-bar"></i> æª¢è¦–çµ±è¨ˆ
           </button>
           <button class="btn btn-outline" onclick="testConnection()" id="testBtn">
               <i class="fas fa-wifi"></i> æ¸¬è©¦é€£ç·š
           </button>
           <button class="btn btn-outline" onclick="toggleSources()">
               <i class="fas fa-list"></i> é¡¯ç¤ºä¾†æº
           </button>
       </div>
      
       <!-- ç‹€æ…‹é¡¯ç¤º -->
       <div class="status-bar" id="statusBar">
           <div class="status-card">
               <div class="status-icon"><i class="fas fa-newspaper" style="color: var(--primary);"></i></div>
               <div class="status-value" id="totalNews">0</div>
               <div class="status-label">ç¸½æ–°èæ•¸</div>
           </div>
           <div class="status-card">
               <div class="status-icon"><i class="fas fa-rss" style="color: var(--secondary);"></i></div>
               <div class="status-value" id="totalSources">0</div>
               <div class="status-label">æ–°èä¾†æº</div>
           </div>
           <div class="status-card">
               <div class="status-icon"><i class="fas fa-tags" style="color: #9c27b0;"></i></div>
               <div class="status-value" id="totalCategories">0</div>
               <div class="status-label">æ–°èåˆ†é¡</div>
           </div>
           <div class="status-card">
               <div class="status-icon"><i class="fas fa-clock" style="color: var(--warning);"></i></div>
               <div class="status-value" id="lastUpdateTime">--:--</div>
               <div class="status-label">æœ€å¾Œæ›´æ–°</div>
           </div>
       </div>
      
       <!-- æ–°èä¾†æºçµ±è¨ˆ -->
       <div class="sources-stats" id="sourcesStats" style="display: none;">
           <h2 class="section-title"><i class="fas fa-satellite-dish"></i> æ–°èä¾†æºçµ±è¨ˆ</h2>
           <div class="sources-grid" id="sourcesGrid"></div>
       </div>
      
       <!-- è¼‰å…¥æŒ‡ç¤ºå™¨ -->
       <div class="loading" id="loading" style="display: none;">
           <div class="loader"></div>
           <p>æ­£åœ¨è¼‰å…¥æ–°èè³‡æ–™...</p>
       </div>
      
       <!-- éŒ¯èª¤è¨Šæ¯ -->
       <div class="error-message" id="errorMessage" style="display: none;">
           <i class="fas fa-exclamation-triangle"></i>
           <div id="errorText"></div>
       </div>
      
       <!-- æœ€å¾Œæ›´æ–°æ™‚é–“ -->
       <div class="last-updated" id="lastUpdated">
           <i class="fas fa-clock"></i> æœ€å¾Œæ›´æ–°æ™‚é–“: <span id="updateTimeText">å°šæœªæ›´æ–°</span>
       </div>
      
       <!-- æ–°èåˆ—è¡¨ -->
       <div class="news-grid" id="newsContainer">
           <!-- æ–°èå¡ç‰‡æœƒå‹•æ…‹ç”Ÿæˆåœ¨é€™è£¡ -->
       </div>
      
       <!-- é å°¾ -->
       <div class="footer">
           <p><i class="fas fa-code"></i> å…¨çƒæ–°èæ”¶é›†ç³»çµ± v3.0</p>
           <p>æ–°èä¾†æº: BBC, CNN, Reuters, AP, Al Jazeera, ä¸­å¤®ç¤¾, ETtoday, è‡ªç”±æ™‚å ±</p>
           <p>ç›®æ¨™æ–°èæ•¸: 50+ å‰‡ | æ›´æ–°é »ç‡: æ¯å°æ™‚è‡ªå‹•æ›´æ–°</p>
       </div>
   </div>
  
   <!-- JavaScript ç¨‹å¼ç¢¼ - ä¿®æ­£ç‰ˆ -->
   <script>
       // ç³»çµ±è¨­å®š
       const CONFIG = {
           // ä¿®æ­£ API URL - ç¢ºä¿æ­£ç¢º
           API_URL: 'https://script.google.com/macros/s/AKfycby-_9Y2ezmU-Li326SeVmCGpeIg6LwaGHF7_5EKng3QlY7sXoP0smrEyboNNLmGW-ui/exec',
           USE_MOCK_DATA: true,  // æš«æ™‚ä½¿ç”¨æ¨¡æ“¬è³‡æ–™
           NEWS_COUNT_TARGET: 50,  // ç›®æ¨™æ–°èæ•¸
           UPDATE_INTERVAL: 300000, // 5åˆ†é˜è‡ªå‹•æ›´æ–°
           
           // 8 å€‹æ–°èä¾†æºï¼ˆ5åœ‹éš› + 3å°ç£ï¼‰
           NEWS_SOURCES: {
               'BBC': { type: 'åœ‹éš›', country: 'UK', icon: 'fas fa-broadcast-tower', color: '#bb1919' },
               'CNN': { type: 'åœ‹éš›', country: 'US', icon: 'fas fa-tv', color: '#cc0000' },
               'Reuters': { type: 'åœ‹éš›', country: 'UK', icon: 'fas fa-newspaper', color: '#ff8000' },
               'AP': { type: 'åœ‹éš›', country: 'US', icon: 'fas fa-newspaper', color: '#333333' },
               'Al Jazeera': { type: 'åœ‹éš›', country: 'QA', icon: 'fas fa-globe-asia', color: '#005f85' },
               'ä¸­å¤®ç¤¾': { type: 'å°ç£', country: 'TW', icon: 'fas fa-landmark', color: '#0066cc' },
               'ETtoday': { type: 'å°ç£', country: 'TW', icon: 'fas fa-tv', color: '#ff6600' },
               'è‡ªç”±æ™‚å ±': { type: 'å°ç£', country: 'TW', icon: 'fas fa-newspaper', color: '#cc0000' }
           },
           
           CATEGORIES: [
               'ç§‘æŠ€', 'è²¡ç¶“', 'æ”¿æ²»', 'å¥åº·', 'ç’°å¢ƒ', 
               'æ•™è‚²', 'é‹å‹•', 'å¨›æ¨‚', 'åœ‹éš›', 'ç¤¾æœƒ'
           ],
           
           CATEGORY_COLORS: {
               'ç§‘æŠ€': 'category-tech',
               'è²¡ç¶“': 'category-finance',
               'æ”¿æ²»': 'category-politics',
               'å¥åº·': 'category-health',
               'ç’°å¢ƒ': 'category-environment',
               'æ•™è‚²': 'category-education',
               'é‹å‹•': 'category-sports',
               'å¨›æ¨‚': 'category-entertainment',
               'åœ‹éš›': 'category-world',
               'ç¤¾æœƒ': 'category-other'
           },
           
           CATEGORY_ICONS: {
               'ç§‘æŠ€': 'fas fa-microchip',
               'è²¡ç¶“': 'fas fa-chart-line',
               'æ”¿æ²»': 'fas fa-landmark',
               'å¥åº·': 'fas fa-heartbeat',
               'ç’°å¢ƒ': 'fas fa-leaf',
               'æ•™è‚²': 'fas fa-graduation-cap',
               'é‹å‹•': 'fas fa-running',
               'å¨›æ¨‚': 'fas fa-film',
               'åœ‹éš›': 'fas fa-globe-americas',
               'ç¤¾æœƒ': 'fas fa-users'
           }
       };
       
       // å…¨åŸŸç‹€æ…‹
       let currentNews = [];
       let currentFilter = 'all';
       let lastUpdateTime = null;
       let autoUpdateInterval = null;
       
       // é é¢è¼‰å…¥å®Œæˆå¾ŒåŸ·è¡Œ
       document.addEventListener('DOMContentLoaded', function() {
           console.log('ğŸŒ å…¨çƒæ–°èç³»çµ±å•Ÿå‹•');
           
           // ç¶å®šæŒ‰éˆ•äº‹ä»¶ï¼ˆç¢ºä¿å¯é»æ“Šï¼‰
           bindButtonEvents();
           
           // è¼‰å…¥æ–°èè³‡æ–™
           loadNews();
           
           // è¨­å®šå®šæ™‚æ›´æ–°
           startAutoUpdate();
       });
       
       // ç¶å®šæŒ‰éˆ•äº‹ä»¶
       function bindButtonEvents() {
           const testBtn = document.getElementById('testBtn');
           const loadBtn = document.getElementById('loadBtn');
           
           if (testBtn) {
               testBtn.addEventListener('click', function(e) {
                   console.log('âœ… æ¸¬è©¦æŒ‰éˆ•è¢«é»æ“Š');
                   testConnection();
               });
           }
           
           if (loadBtn) {
               loadBtn.addEventListener('click', function(e) {
                   console.log('âœ… è¼‰å…¥æŒ‰éˆ•è¢«é»æ“Š');
                   loadNews();
               });
           }
           
           console.log('æŒ‰éˆ•äº‹ä»¶ç¶å®šå®Œæˆ');
       }
       
       // ä¿®æ­£ï¼šæ¸¬è©¦é€£ç·šå‡½æ•¸
       async function testConnection() {
           console.log('ğŸ” é–‹å§‹æ¸¬è©¦é€£ç·š...');
           
           // é¡¯ç¤ºè¼‰å…¥ç‹€æ…‹
           const originalText = document.getElementById('testBtn').innerHTML;
           document.getElementById('testBtn').innerHTML = '<i class="fas fa-spinner fa-spin"></i> æ¸¬è©¦ä¸­...';
           document.getElementById('testBtn').disabled = true;
           
           try {
               // æ¸¬è©¦ API é€£ç·š
               const testUrl = CONFIG.API_URL + '?action=test&t=' + Date.now();
               console.log('æ¸¬è©¦ URL:', testUrl);
               
               const response = await fetch(testUrl, {
                   method: 'GET',
                   mode: 'cors',
                   cache: 'no-cache'
               });
               
               console.log('å›æ‡‰ç‹€æ…‹:', response.status, response.statusText);
               
               if (response.ok) {
                   const data = await response.json();
                   console.log('API å›æ‡‰:', data);
                   
                   if (data.success) {
                       showMessage(`âœ… é€£ç·šæˆåŠŸï¼ç‰ˆæœ¬: ${data.version || '1.0.0'}`, 'success');
                       alert(`âœ… API é€£ç·šæ­£å¸¸\nç‰ˆæœ¬: ${data.version || '1.0.0'}\næ™‚é–“: ${new Date().toLocaleTimeString()}`);
                   } else {
                       showMessage(`âš ï¸ API å›æ‡‰éŒ¯èª¤: ${data.error || 'æœªçŸ¥éŒ¯èª¤'}`, 'warning');
                       alert(`âš ï¸ API éŒ¯èª¤: ${data.error || 'æœªçŸ¥éŒ¯èª¤'}`);
                   }
               } else {
                   showMessage(`âŒ HTTP éŒ¯èª¤: ${response.status}`, 'error');
                   alert(`âŒ é€£ç·šå¤±æ•—\nHTTP ç‹€æ…‹ç¢¼: ${response.status}\nè«‹æª¢æŸ¥ API URL å’Œ CORS è¨­å®š`);
               }
               
           } catch (error) {
               console.error('é€£ç·šæ¸¬è©¦å¤±æ•—:', error);
               showMessage(`âŒ é€£ç·šå¤±æ•—: ${error.message}`, 'error');
               
               // æä¾›è©³ç´°éŒ¯èª¤è³‡è¨Š
               let errorMsg = `é€£ç·šéŒ¯èª¤:\n${error.message}\n\n`;
               errorMsg += `å¯èƒ½åŸå› :\n`;
               errorMsg += `1. API URL ä¸æ­£ç¢º\n`;
               errorMsg += `2. CORS è¨­å®šå•é¡Œ\n`;
               errorMsg += `3. ç¶²è·¯é€£ç·šå•é¡Œ\n`;
               errorMsg += `4. GAS æœªéƒ¨ç½²ç‚ºç¶²é æ‡‰ç”¨ç¨‹å¼`;
               
               alert(errorMsg);
               
           } finally {
               // æ¢å¾©æŒ‰éˆ•ç‹€æ…‹
               document.getElementById('testBtn').innerHTML = originalText;
               document.getElementById('testBtn').disabled = false;
           }
       }
       
       // è¼‰å…¥æ–°èè³‡æ–™
       async function loadNews() {
           showLoading(true);
           hideError();
           
           try {
               if (CONFIG.USE_MOCK_DATA) {
                   console.log('ğŸ“Š ä½¿ç”¨æ¨¡æ“¬è³‡æ–™ (50å‰‡æ–°è)');
                   await loadMockData();
               } else {
                   console.log('ğŸŒ å˜—è©¦é€£æ¥çœŸå¯¦ API...');
                   await loadRealData();
               }
               
               showMessage(`âœ… æˆåŠŸè¼‰å…¥ ${currentNews.length} å‰‡æ–°è`, 'success');
               
           } catch (error) {
               console.error('è¼‰å…¥å¤±æ•—:', error);
               
               // è‡ªå‹•åˆ‡æ›åˆ°æ¨¡æ“¬è³‡æ–™
               if (!CONFIG.USE_MOCK_DATA) {
                   CONFIG.USE_MOCK_DATA = true;
                   showMessage('âš ï¸ API é€£ç·šå¤±æ•—ï¼Œå·²åˆ‡æ›åˆ°æ¨¡æ“¬è³‡æ–™', 'warning');
                   await loadMockData();
               } else {
                   showError(`è¼‰å…¥å¤±æ•—: ${error.message}`);
               }
               
           } finally {
               showLoading(false);
           }
       }
       
       // è¼‰å…¥æ¨¡æ“¬è³‡æ–™ï¼ˆ50å‰‡æ–°èï¼‰
       async function loadMockData() {
           // æ¨¡æ“¬ç¶²è·¯å»¶é²
           await new Promise(resolve => setTimeout(resolve, 1000));
           
           const mockData = generateMockData(50); // ç”Ÿæˆ50å‰‡æ–°è
           processNewsData(mockData);
           lastUpdateTime = new Date();
       }
       
       // è¼‰å…¥çœŸå¯¦è³‡æ–™
       async function loadRealData() {
           const response = await fetch(CONFIG.API_URL + '?t=' + Date.now());
           
           if (!response.ok) {
               throw new Error(`HTTP éŒ¯èª¤: ${response.status}`);
           }
           
           const result = await response.json();
           
           if (!result.success) {
               throw new Error(result.error || 'API éŒ¯èª¤');
           }
           
           processNewsData(result.data);
       }
       
       // ç”Ÿæˆæ¨¡æ“¬è³‡æ–™
       function generateMockData(count) {
           const sources = Object.keys(CONFIG.NEWS_SOURCES);
           const categories = CONFIG.CATEGORIES;
           
           const news = [];
           const sourceCount = {};
           const categoryCount = {};
           
           for (let i = 1; i <= count; i++) {
               const source = sources[Math.floor(Math.random() * sources.length)];
               const category = categories[Math.floor(Math.random() * categories.length)];
               
               // çµ±è¨ˆ
               sourceCount[source] = (sourceCount[source] || 0) + 1;
               categoryCount[category] = (categoryCount[category] || 0) + 1;
               
               news.push({
                   id: i,
                   title: `æ–°èæ¨™é¡Œ ${i}: ${getRandomTopic()} - ${category}é¡`,
                   summary: `é€™æ˜¯ç¬¬ ${i} å‰‡æ¨¡æ“¬æ–°èï¼Œä¾†æºæ–¼ ${source}ã€‚å…§å®¹é—œæ–¼${getRandomTopic()}çš„ç›¸é—œå ±å°ï¼Œå±¬æ–¼${category}é¡åˆ¥ã€‚`,
                   category: category,
                   source: source,
                   link: '#',
                   date: getRandomDate(),
                   timestamp: Date.now() - Math.random() * 86400000 * 7 // 7å¤©å…§
               });
           }
           
           // ç”Ÿæˆç†±é–€é—œéµå­—
           const hotKeywords = [
               {keyword: 'åœ‹éš›æ–°è', count: Math.floor(Math.random() * 20) + 10, size: 22},
               {keyword: 'ç§‘æŠ€ç™¼å±•', count: Math.floor(Math.random() * 15) + 8, size: 20},
               {keyword: 'ç¶“æ¿Ÿè¶¨å‹¢', count: Math.floor(Math.random() * 15) + 5, size: 18},
               {keyword: 'æ”¿æ²»å‹•æ…‹', count: Math.floor(Math.random() * 12) + 5, size: 16},
               {keyword: 'ç’°å¢ƒä¿è­·', count: Math.floor(Math.random() * 10) + 3, size: 14}
           ];
           
           return {
               news: news,
               statistics: {
                   total: count,
                   bySource: sourceCount,
                   byCategory: categoryCount,
                   lastUpdated: new Date().toISOString()
               },
               hotKeywords: hotKeywords
           };
       }
       
       // å·¥å…·å‡½æ•¸
       function getRandomTopic() {
           const topics = [
               'äººå·¥æ™ºèƒ½ç™¼å±•', 'å…¨çƒç¶“æ¿Ÿè¶¨å‹¢', 'æ°£å€™è®Šé·æœƒè­°', 'ç§‘æŠ€å‰µæ–°', 'åœ‹éš›é—œä¿‚',
               'é†«ç™‚çªç ´', 'æ•™è‚²æ”¹é©', 'é‹å‹•è³½äº‹', 'å¨›æ¨‚ç”¢æ¥­', 'ç¤¾æœƒè­°é¡Œ',
               'é‡‘èå¸‚å ´', 'èƒ½æºæ”¿ç­–', 'å¤ªç©ºæ¢ç´¢', 'ç¶²è·¯å®‰å…¨', 'æ–‡åŒ–ç™¼å±•'
           ];
           return topics[Math.floor(Math.random() * topics.length)];
       }
       
       function getRandomDate() {
           const date = new Date();
           date.setDate(date.getDate() - Math.floor(Math.random() * 7));
           date.setHours(Math.floor(Math.random() * 24));
           date.setMinutes(Math.floor(Math.random() * 60));
           return date.toISOString();
       }
       
       // è™•ç†æ–°èè³‡æ–™
       function processNewsData(data) {
           if (!data || !data.news) {
               throw new Error('ç„¡æ•ˆçš„è³‡æ–™æ ¼å¼');
           }
           
           currentNews = data.news || [];
           
           // é¡¯ç¤ºçµ±è¨ˆè³‡æ–™
           displayStatistics(data.statistics);
           
           // é¡¯ç¤ºæ–°èåˆ—è¡¨
           displayNewsList(currentNews);
           
           // æ›´æ–°æœ€å¾Œæ›´æ–°æ™‚é–“
           updateLastUpdatedTime(data.statistics?.lastUpdated);
           
           console.log(`ğŸ“ˆ è™•ç†å®Œæˆ: ${currentNews.length} å‰‡æ–°è`);
       }
       
       // é¡¯ç¤ºçµ±è¨ˆè³‡æ–™
       function displayStatistics(statistics) {
           if (!statistics) return;
           
           const totalNews = statistics.total || 0;
           const sourceCount = Object.keys(statistics.bySource || {}).length;
           const categoryCount = Object.keys(statistics.byCategory || {}).length;
           
           document.getElementById('totalNews').textContent = totalNews;
           document.getElementById('totalSources').textContent = sourceCount;
           document.getElementById('totalCategories').textContent = categoryCount;
           
           // æ›´æ–°æœ€å¾Œæ›´æ–°æ™‚é–“é¡¯ç¤º
           if (statistics.lastUpdated) {
               const date = new Date(statistics.lastUpdated);
               const timeStr = date.toLocaleTimeString('zh-TW', {
                   hour: '2-digit',
                   minute: '2-digit',
                   hour12: false
               });
               document.getElementById('lastUpdateTime').textContent = timeStr;
           }
           
           // æ›´æ–°ä¾†æºçµ±è¨ˆ
           updateSourcesStats(statistics.bySource);
       }
       
       // æ›´æ–°ä¾†æºçµ±è¨ˆ
       function updateSourcesStats(bySource) {
           if (!bySource) return;
           
           const sourcesGrid = document.getElementById('sourcesGrid');
           if (!sourcesGrid) return;
           
           let html = '';
           Object.entries(bySource).forEach(([source, count]) => {
               const sourceInfo = CONFIG.NEWS_SOURCES[source] || { type: 'å…¶ä»–', icon: 'fas fa-rss', color: '#666' };
               const typeClass = sourceInfo.type === 'å°ç£' ? 'tw' : 'intl';
               
               html += `
                   <div class="source-item">
                       <div class="source-name">
                           <i class="${sourceInfo.icon}" style="color: ${sourceInfo.color};"></i>
                           <span>${source}</span>
                           <small style="color: #666;">(${sourceInfo.type})</small>
                       </div>
                       <div class="source-count">${count}</div>
                   </div>
               `;
           });
           
           sourcesGrid.innerHTML = html;
       }
       
       // é¡¯ç¤ºæ–°èåˆ—è¡¨
       function displayNewsList(news) {
           const container = document.getElementById('newsContainer');
           
           if (!news || news.length === 0) {
               container.innerHTML = `
                   <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: var(--gray);">
                       <i class="fas fa-inbox" style="font-size: 3rem; margin-bottom: 20px;"></i>
                       <h3>æš«ç„¡æ–°èè³‡æ–™</h3>
                       <p>è«‹ç¨å¾Œå†è©¦æˆ–æª¢æŸ¥ç¶²è·¯é€£æ¥</p>
                   </div>
               `;
               return;
           }
           
           let html = '';
           news.forEach(item => {
               const categoryClass = CONFIG.CATEGORY_COLORS[item.category] || 'category-other';
               const categoryIcon = CONFIG.CATEGORY_ICONS[item.category] || 'fas fa-newspaper';
               const sourceInfo = CONFIG.NEWS_SOURCES[item.source] || { icon: 'fas fa-rss', color: '#666' };
               
               html += `
                   <div class="news-card">
                       <div class="news-category ${categoryClass}">
                           <i class="${categoryIcon}"></i> ${item.category || 'å…¶ä»–'}
                       </div>
                       <div class="news-content">
                           <h3 class="news-title">${escapeHtml(item.title || 'ç„¡æ¨™é¡Œ')}</h3>
                           <p class="news-summary">${escapeHtml(item.summary || 'ç„¡æ‘˜è¦')}</p>
                           <a href="${item.link || '#'}" class="news-link" target="_blank" rel="noopener noreferrer">
                               <i class="fas fa-external-link-alt"></i> é–±è®€åŸæ–‡
                           </a>
                           <div class="news-meta">
                               <div class="news-source">
                                   <i class="${sourceInfo.icon}" style="color: ${sourceInfo.color};"></i> ${item.source || 'æœªçŸ¥ä¾†æº'}
                               </div>
                               <div class="news-date">
                                   ${formatDate(item.date) || formatDate(item.timestamp)}
                               </div>
                           </div>
                       </div>
                   </div>
               `;
           });
           
           container.innerHTML = html;
       }
       
       // é¡¯ç¤ºçµ±è¨ˆè©³æƒ…
       function showStats() {
           if (currentNews.length === 0) {
               showMessage('å°šæœªè¼‰å…¥æ–°èè³‡æ–™', 'warning');
               return;
           }
           
           const categories = {};
           const sources = {};
           
           currentNews.forEach(item => {
               const cat = item.category || 'å…¶ä»–';
               const src = item.source || 'æœªçŸ¥ä¾†æº';
               
               categories[cat] = (categories[cat] || 0) + 1;
               sources[src] = (sources[src] || 0) + 1;
           });
           
           let message = `ğŸ“Š ç³»çµ±çµ±è¨ˆ\n\n`;
           message += `ç¸½æ–°èæ•¸: ${currentNews.length}\n`;
           message += `ç›®æ¨™æ•¸é‡: ${CONFIG.NEWS_COUNT_TARGET}\n`;
           message += `å®Œæˆåº¦: ${Math.round((currentNews.length / CONFIG.NEWS_COUNT_TARGET) * 100)}%\n\n`;
           message += `ğŸ“° ä¾†æºåˆ†å¸ƒ:\n`;
           Object.entries(sources).forEach(([source, count]) => {
               message += `  ${source}: ${count} å‰‡\n`;
           });
           message += `\nğŸ·ï¸ åˆ†é¡åˆ†å¸ƒ:\n`;
           Object.entries(categories).forEach(([category, count]) => {
               message += `  ${category}: ${count} å‰‡\n`;
           });
           
           alert(message);
       }
       
       // åˆ‡æ›ä¾†æºé¡¯ç¤º
       function toggleSources() {
           const sourcesStats = document.getElementById('sourcesStats');
           sourcesStats.style.display = sourcesStats.style.display === 'none' ? 'block' : 'none';
       }
       
       // é–‹å§‹è‡ªå‹•æ›´æ–°
       function startAutoUpdate() {
           if (autoUpdateInterval) {
               clearInterval(autoUpdateInterval);
           }
           
           autoUpdateInterval = setInterval(() => {
               console.log('ğŸ”„ è‡ªå‹•æ›´æ–°æ–°èè³‡æ–™...');
               loadNews();
           }, CONFIG.UPDATE_INTERVAL);
           
           console.log(`â° å·²è¨­å®šè‡ªå‹•æ›´æ–°ï¼Œé–“éš”: ${CONFIG.UPDATE_INTERVAL / 1000} ç§’`);
       }
       
       // å·¥å…·å‡½æ•¸
       function showLoading(show) {
           document.getElementById('loading').style.display = show ? 'block' : 'none';
       }
       
       function showError(message) {
           document.getElementById('errorText').textContent = message;
           document.getElementById('errorMessage').style.display = 'flex';
       }
       
       function hideError() {
           document.getElementById('errorMessage').style.display = 'none';
       }
       
       function showMessage(text, type = 'info') {
           console.log(`${type}: ${text}`);
       }
       
       function updateLastUpdatedTime(timestamp) {
           const timeStr = timestamp ? 
               new Date(timestamp).toLocaleString('zh-TW') : 
               new Date().toLocaleString('zh-TW');
           document.getElementById('updateTimeText').textContent = timeStr;
       }
       
       function formatDate(dateStr) {
           try {
               const date = new Date(dateStr);
               return date.toLocaleDateString('zh-TW', {
                   month: '2-digit',
                   day: '2-digit',
                   hour: '2-digit',
                   minute: '2-digit'
               });
           } catch (e) {
               return dateStr || 'æœªçŸ¥æ—¥æœŸ';
           }
       }
       
       function escapeHtml(text) {
           if (!text) return '';
           const div = document.createElement('div');
           div.textContent = text;
           return div.innerHTML;
       }
       
       // åˆå§‹åŒ–å®Œæˆ
       console.log('âœ… å…¨çƒæ–°èç³»çµ±åˆå§‹åŒ–å®Œæˆ');
   </script>
</body>
</html>
